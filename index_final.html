
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçâ Ïª§Ïä§ÌÖÄ ÏàòÎ∞ï Í≤åÏûÑ</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            text-align: center;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 0 30px rgba(0,0,0,0.2);
        }
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .score {
            font-size: 1.2em;
            margin-bottom: 20px;
        }
        canvas {
            border: 4px solid #333;
            border-radius: 20px;
            background: linear-gradient(180deg, #f0f8ff 0%, #e6f3ff 100%);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üçâ ÏàòÎ∞ï Í≤åÏûÑ</h1>
        <div class="score">Ï†êÏàò: <span id="score">0</span></div>
        <canvas id="gameCanvas" width="400" height="600"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        let fruits = [];
        let currentFruit = null;
        let gameRunning = true;
        let gamePaused = false;
        let score = 0;
        let mouseX = canvas.width / 2;
        let customImages = [];
        let imagesLoaded = 0;

        const fruitConfig = Array.from({ length: 11 }, (_, i) => ({
            size: 20 + i * 5,
            color: '#' + Math.floor(Math.random() * 16777215).toString(16),
            name: `Fruit${i + 1}`,
            file: `fruit${i + 1}.jpg`
        }));

        function loadCustomImages() {
            fruitConfig.forEach((config, index) => {
                const img = new Image();
                img.onload = () => {
                    customImages[index] = img;
                    imagesLoaded++;
                };
                img.onerror = () => {
                    imagesLoaded++;
                };
                img.src = `images/${config.file}`;
            });
        }

        class Fruit {
            constructor(x, y, type) {
                this.x = x;
                this.y = y;
                this.type = type;
                this.size = fruitConfig[type].size;
                this.vx = 0;
                this.vy = 0;
                this.onGround = false;
                this.merged = false;
            }

            update() {
                if (!this.onGround) {
                    this.vy += 0.3;
                    this.y += this.vy;
                    this.x += this.vx;

                    if (this.y + this.size >= canvas.height) {
                        this.y = canvas.height - this.size;
                        this.vy = 0;
                        this.onGround = true;
                    }
                }
            }

            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                if (customImages[this.type]) {
                    ctx.drawImage(customImages[this.type], -this.size, -this.size, this.size * 2, this.size * 2);
                } else {
                    ctx.fillStyle = fruitConfig[this.type].color;
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                    ctx.fill();
                }
                ctx.restore();
            }
        }

        function createNextFruit() {
            const nextType = Math.floor(Math.random() * 5);
            currentFruit = new Fruit(mouseX, 50, nextType);
        }

        function dropFruit() {
            if (currentFruit && gameRunning && !gamePaused) {
                currentFruit.vy = 2;
                fruits.push(currentFruit);
                createNextFruit();
            }
        }

        function mergeFruits(f1, f2, i1, i2) {
            const newX = (f1.x + f2.x) / 2;
            const newY = (f1.y + f2.y) / 2;
            const newType = f1.type + 1;

            score += (newType + 1) * 10;
            document.getElementById("score").textContent = score;

            fruits.splice(Math.max(i1, i2), 1);
            fruits.splice(Math.min(i1, i2), 1);

            if (newType < fruitConfig.length) {
                const newFruit = new Fruit(newX, newY, newType);
                newFruit.onGround = true;
                fruits.push(newFruit);
            }
        }

        function checkCollisions() {
            for (let i = 0; i < fruits.length; i++) {
                for (let j = i + 1; j < fruits.length; j++) {
                    const a = fruits[i];
                    const b = fruits[j];
                    const dx = a.x - b.x;
                    const dy = a.y - b.y;
                    const dist = Math.sqrt(dx * dx + dy * dy);

                    if (dist < a.size + b.size) {
                        if (a.type === b.type && !a.merged && !b.merged && a.type < fruitConfig.length - 1) {
                            mergeFruits(a, b, i, j);
                            return;
                        }
                    }
                }
            }
        }

        function gameLoop() {
            if (!gameRunning || gamePaused) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            fruits.forEach(f => {
                f.update();
                f.draw();
            });
            if (currentFruit) {
                currentFruit.x = mouseX;
                currentFruit.draw();
            }
            checkCollisions();
            requestAnimationFrame(gameLoop);
        }

        canvas.addEventListener("mousemove", e => {
            const rect = canvas.getBoundingClientRect();
            mouseX = e.clientX - rect.left;
        });

        canvas.addEventListener("click", dropFruit);
        document.addEventListener("keydown", e => {
            if (e.code === "Space") dropFruit();
        });

        // Í≤åÏûÑ ÏãúÏûë
        loadCustomImages();
        createNextFruit();
        gameLoop();
    </script>
</body>
</html>
